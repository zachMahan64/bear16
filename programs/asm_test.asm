#FULL WORKING ASCII extremely basic text processor (no input handling yet, though) TUE 20250617
.data
ctset_start: #Char Tile Set (ASCII)
ctset_0:
.byte 0b00000000 0b00010000 0b01010000 0b00101000 0b00010000 0b11000010 0b01100000 0b00010000 0b00000110 0b11000000 0b01010100 0b00000000 0b00000000 0b00000000 0b00000000 0b00000010 0b00111000 0b00010000 0b00111000 0b00111000 0b01000100 0b01111100 0b01111100 0b01111100 0b00111000 0b00111000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00111000
.byte 0b00000000 0b00010000 0b01010000 0b00101000 0b01111100 0b11000100 0b10000010 0b00010000 0b00001000 0b00100000 0b00111000 0b00010000 0b00000000 0b00000000 0b00000000 0b00000100 0b01000100 0b00110000 0b01000100 0b01000100 0b01000100 0b01000000 0b10000000 0b00000100 0b01000100 0b01000100 0b01100000 0b01100000 0b00000110 0b00000000 0b11000000 0b01000100
.byte 0b00000000 0b00010000 0b00000000 0b11111110 0b10010000 0b00001000 0b10001100 0b00000000 0b00001000 0b00100000 0b01111100 0b00010000 0b00000000 0b00000000 0b00000000 0b00001000 0b01000100 0b00010000 0b01000100 0b00000100 0b01000100 0b01000000 0b10000000 0b00001000 0b01000100 0b01000100 0b01100000 0b01100000 0b00011000 0b01111100 0b00110000 0b00000100
.byte 0b00000000 0b00010000 0b00000000 0b00101000 0b01111100 0b00010000 0b01111000 0b00000000 0b00001000 0b00100000 0b00111000 0b01111100 0b00000000 0b00111000 0b00000000 0b00010000 0b01000100 0b00010000 0b00011000 0b00111000 0b01111110 0b01111000 0b11111100 0b00010000 0b00111000 0b00111100 0b00000000 0b00000000 0b01100000 0b00000000 0b00001100 0b00011000
.byte 0b00000000 0b00010000 0b00000000 0b11111110 0b00010010 0b00100000 0b10001100 0b00000000 0b00001000 0b00100000 0b01010100 0b00010000 0b01000000 0b00000000 0b00000000 0b00100000 0b01000100 0b00010000 0b00100000 0b00000100 0b00000100 0b00000100 0b10000010 0b00010000 0b01000100 0b00000100 0b01100000 0b01100000 0b00011000 0b01111100 0b00110000 0b00010000
.byte 0b00000000 0b00000000 0b00000000 0b00101000 0b01111100 0b01000110 0b10001010 0b00000000 0b00001000 0b00100000 0b00000000 0b00010000 0b01000000 0b00000000 0b01100000 0b01000000 0b01000100 0b00010000 0b01000000 0b01000100 0b00000100 0b00000100 0b10000010 0b00010000 0b01000100 0b00000100 0b01100000 0b01100000 0b00000110 0b00000000 0b11000000 0b00000000
.byte 0b00000000 0b00010000 0b00000000 0b00101000 0b00010000 0b10000110 0b01110000 0b00000000 0b00000110 0b11000000 0b00000000 0b00000000 0b10000000 0b00000000 0b01100000 0b10000000 0b00111000 0b00111000 0b01111100 0b00111000 0b00000100 0b01111000 0b01111100 0b00010000 0b00111000 0b00011000 0b00000000 0b00100000 0b00000000 0b00000000 0b00000000 0b00010000
.byte 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000
ctset_1:
.byte 0b01111100 0b00010000 0b10111100 0b01111100 0b10111100 0b11111110 0b11111110 0b01111110 0b10000010 0b11111110 0b01111110 0b10000010 0b01000000 0b10000010 0b10000010 0b01111100 0b10111100 0b01111100 0b10111100 0b01111100 0b11111110 0b10000010 0b10000010 0b10000010 0b10000010 0b10000010 0b11111110 0b00001110 0b10000000 0b11100000 0b00010000 0b00000000
.byte 0b00000010 0b00101000 0b11000010 0b10000010 0b11000010 0b10000000 0b10000000 0b10000000 0b10000010 0b00010000 0b00001000 0b10000010 0b01000000 0b11000110 0b11000010 0b10000010 0b11000010 0b10000010 0b11000010 0b10000010 0b00010000 0b10000010 0b10000010 0b10000010 0b01000100 0b10000010 0b00000100 0b00001000 0b01000000 0b00100000 0b00101000 0b00000000
.byte 0b01110010 0b01000100 0b10000010 0b10000000 0b10000010 0b10000000 0b10000000 0b10000000 0b10000010 0b00010000 0b00001000 0b10000100 0b01000000 0b10101010 0b10100010 0b10000010 0b10000010 0b10000010 0b10000010 0b10000000 0b00010000 0b10000010 0b10000010 0b10000010 0b00101000 0b01000100 0b00001000 0b00001000 0b00100000 0b00100000 0b01000100 0b00000000
.byte 0b10001010 0b10000010 0b11111100 0b10000000 0b10000010 0b11111110 0b11111110 0b10001110 0b11111110 0b00010000 0b00001000 0b11111100 0b01000000 0b10010010 0b10010010 0b10000010 0b11000010 0b10000010 0b11000010 0b01111100 0b00010000 0b10000010 0b10000010 0b10010010 0b00010000 0b00101000 0b00010000 0b00001000 0b00010000 0b00100000 0b00000000 0b00000000
.byte 0b10001010 0b11111110 0b10000010 0b10000000 0b10000010 0b10000000 0b10000000 0b10000010 0b10000010 0b00010000 0b00001000 0b10000010 0b01000000 0b10000010 0b10001010 0b10000010 0b10111100 0b10001010 0b10111100 0b00000010 0b00010000 0b10000010 0b01000100 0b10010010 0b00101000 0b00010000 0b00100000 0b00001000 0b00001000 0b00100000 0b00000000 0b00000000
.byte 0b10010010 0b10000010 0b11000010 0b10000010 0b11000010 0b10000000 0b10000000 0b11000010 0b10000010 0b00010000 0b10001000 0b10000010 0b01000000 0b10000010 0b10000110 0b10000010 0b10000000 0b10000100 0b10000100 0b10000010 0b00010000 0b10000010 0b00101000 0b10101010 0b01000100 0b00010000 0b01000000 0b00001000 0b00000100 0b00100000 0b00000000 0b00000000
.byte 0b01111100 0b10000010 0b10111100 0b01111100 0b10111100 0b11111110 0b10000000 0b10111110 0b10000010 0b11111110 0b01110000 0b10000010 0b01111100 0b10000010 0b10000010 0b01111100 0b10000000 0b01111010 0b10000010 0b01111100 0b00010000 0b01111100 0b00010000 0b01000100 0b10000010 0b00010000 0b11111110 0b00001110 0b00000010 0b11100000 0b00000000 0b11111110
.byte 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000
ctset_2:
.byte 0b00000100 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000110 0b00010000 0b11000000 0b00000000 0b00000000
.byte 0b00000010 0b00000000 0b01000000 0b00000000 0b00000100 0b00000000 0b00111000 0b00000000 0b01000000 0b00010000 0b00010000 0b01000000 0b00010000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00010000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00001000 0b00010000 0b00100000 0b00000000 0b00000000
.byte 0b00000000 0b00111000 0b01000000 0b00111100 0b00000100 0b00111000 0b01000000 0b00111100 0b01000000 0b00000000 0b00000000 0b01001000 0b00010000 0b01101000 0b01111000 0b00111000 0b01111000 0b00111100 0b00010100 0b00111100 0b00010000 0b01000100 0b01000100 0b01000100 0b01000100 0b01000100 0b01111100 0b00001000 0b00010000 0b00100000 0b00000010 0b00000000
.byte 0b00000000 0b00000100 0b01111000 0b01000000 0b00111100 0b01000100 0b01000000 0b01000100 0b01111000 0b00010000 0b00010000 0b01001000 0b00010000 0b01010100 0b01000100 0b01000100 0b01000100 0b01000100 0b00011000 0b01000000 0b00111000 0b01000100 0b01000100 0b01000100 0b00101000 0b00111100 0b00001000 0b00110000 0b00010000 0b00011000 0b01111100 0b00000000
.byte 0b00000000 0b00111100 0b01000100 0b01000000 0b01000100 0b01111000 0b01111000 0b00111100 0b01000100 0b00010000 0b00010000 0b01110000 0b00010000 0b01010100 0b01000100 0b01000100 0b01000100 0b01000100 0b00010000 0b00111100 0b00010000 0b01000100 0b00101000 0b01010100 0b00010000 0b00000100 0b00010000 0b00001000 0b00010000 0b00100000 0b10000000 0b00000000
.byte 0b00000000 0b01000100 0b01000100 0b01000000 0b01000100 0b01000000 0b01000000 0b00000100 0b01000100 0b00010000 0b00010000 0b01001000 0b00010000 0b01000100 0b01000100 0b01000100 0b01111000 0b00111100 0b00010000 0b00000010 0b00010000 0b01000100 0b00101000 0b01010100 0b00101000 0b00000100 0b00100000 0b00001000 0b00010000 0b00100000 0b00000000 0b00000000
.byte 0b00000000 0b00111100 0b01111000 0b00111100 0b00111100 0b00111000 0b10000000 0b01111000 0b01000100 0b00010000 0b01100000 0b01001000 0b00001000 0b01000100 0b01000100 0b00111000 0b01000000 0b00000100 0b00010000 0b00111100 0b00010000 0b00111100 0b00010000 0b00101000 0b01000100 0b00111000 0b01111100 0b00000110 0b00010000 0b11000000 0b00000000 0b00000000
.byte 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b01000000 0b00000110 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000
ctset_3:
.byte 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000
.byte 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000
.byte 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000
.byte 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000
.byte 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000
.byte 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000
.byte 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000
.byte 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000 0b00000000
ctset_end:

my_str_0:
    .string "Hello World"
my_str_1:
    .string "We have all of printable ASCII!"
my_str_2:
    .string "Working on IO now!"

.text
.const FB_LOC = 0
.const LINE_SIZE = 256
.const TILE_MAP_SIZE = 256
.const LINE_WIDTH_B = 32
.const IO_LOC = 6143

start:
    sub s10, ctset_end, ctset_start
    romcpy FB_LOC, ctset_start, s10 # s10 = length of Char Tile Set

    mov a0, 5 # line
    mov a1, 0 # index
    mov a2, my_str_0
    call blit_strl_rom #blitting a str

    mov a0, 6 # line
    mov a1, 0 # index
    mov a2, my_str_1
    call blit_strl_rom #blitting a str

    mov a0, 7 # line
    mov a1, 0 # index
    mov a2, my_str_2
    call blit_strl_rom #blitting a str

    #call utility_inf_loop
    mov a0, 9
    call main
    hlt



main:
    # a0 = starting line
    mov s1, a0 # s1 = line ptr
    main_loop:
    lb t0, IO_LOC
    ugt subr_print_new_char, t0, 0
    jmp main_loop
    ret
    subr_print_new_char:
        # s0 = current char* to print
        mov a0, s1
        mov a1, s0     # a1 = index
        lb a2, IO_LOC # a2 = char
        call blit_cl # a0, a1, a2 used
        inc s0
        lea t0, IO_LOC
        sb t0, 0 # clear IO memory location
        uge subr_go_on_newline, s0, LINE_WIDTH_B
        jmp main_loop
        subr_go_on_newline:
            inc s1 # next line!
            clr s0 # set index on line back to zero
            jmp main_loop


utility_inf_loop:
    jmp utility_inf_loop
    ret
    
blit_cl:
    #a0 = line, a1 = index, a2 = desired char
    mult t0, a0, LINE_SIZE # set line
    add t0, t0, a1 # set index
    sub t1, a2, 32 # get char index in rom
    div t7, t1, 32
    mov t8, t7 #save this
    mult t7, t7, LINE_SIZE
    add t1, t1, t7
    mult t8, t8, 32
    sub t1, t1, t8
    add t1, t1, ctset_start
    clr t2 # cnt
    bcl_loop:
        lbrom t3, t1       #load byte from rom in t3
        sb t0, t3          #store byte in t3 into addr @ t0
        add t0, t0, LINE_WIDTH_B     # t0 += 32
        add t1, t1, LINE_WIDTH_B     # t1 += 32
        inc t2             # t2++
        ult bcl_loop, t2, 8 # check cnt
    ret
blit_strl_rom:
    #a0 = line, a1 = index, a2 = char*
    mov t5, a2 # current char ptr
    bstrl_rom_loop:
        lbrom a2, t5 # a2 <- *char
        eq bstrl_ret, a2, 0
        call blit_cl #reuse a0 & a1
        inc a1
        inc t5
        jmp bstrl_rom_loop
    bstrl_ret:
        ret